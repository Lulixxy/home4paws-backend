<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Reviews - Home4Paws üêæ</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">

    <link rel="stylesheet" th:href="@{/css/admin-style.css}">
</head>
<body>

<nav class="navbar navbar-dark navbar-custom sticky-top">
    <div class="container">
        <a class="navbar-brand fw-bold d-flex align-items-center" href="#">
            <img th:src="@{/images/logo.png}" alt="Logo"
                 style="height: 40px; width: auto; margin-right: 10px;">
            Home4Paws Admin
        </a>
        <div class="d-flex align-items-center">
            <a href="/admin/dashboard" class="btn btn-outline-light btn-sm me-2">
                <i class="fas fa-list me-1"></i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏û‡∏™‡∏ï‡πå
            </a>
            <a href="/admin/reviews" class="btn btn-light btn-sm fw-bold text-success me-2">
                <i class="fas fa-star me-1"></i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡∏ß‡∏¥‡∏ß
            </a>
            <a href="/admin/logout" class="btn btn-logout btn-sm ms-2">
                <i class="fas fa-sign-out-alt me-1"></i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
            </a>
        </div>
    </div>
</nav>

<div class="container mb-5">
    <div class="table-card animate__animated animate__fadeIn">

        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="page-title mb-0">
                <i class="fas fa-star-half-alt me-2"></i>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏µ‡∏ß‡∏¥‡∏ß & ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
            </h2>
            <span class="badge rounded-pill bg-light text-dark border p-2 px-3 shadow-sm">
                    Total: <span th:text="${reviews.size()}" class="fw-bold">0</span> Reviews
                </span>
        </div>

        <div class="d-flex gap-2 mb-3">
            <a href="/admin/reviews"
               th:class="${filterMode == 'all' ? 'btn btn-success btn-sm' : 'btn btn-outline-success btn-sm'}">
                <i class="fas fa-list me-1"></i> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            </a>
            <a href="/admin/reviews?filter=bad"
               th:class="${filterMode == 'bad' ? 'btn btn-danger btn-sm' : 'btn btn-outline-danger btn-sm'}">
                <i class="fas fa-exclamation-circle me-1"></i> ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 3 (Bad Reviews)
            </a>
        </div>

        <div class="table-responsive">
            <table class="table table-hover align-middle" th:if="${!reviews.isEmpty()}">
                <thead>
                <tr>
                    <th scope="col" width="10%">ID</th>
                    <th scope="col" width="15%">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                    <th scope="col" width="30%">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô</th>
                    <th scope="col" width="20%">‡∏ú‡∏π‡πâ‡∏ñ‡∏π‡∏Å‡∏£‡∏µ‡∏ß‡∏¥‡∏ß (Adopter)</th>
                    <th scope="col" width="10%">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                    <th scope="col" width="15%" class="text-center">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="review : ${reviews}">
                    <td class="text-muted fw-bold" th:text="${'#' + review.reviewId}"></td>
                    <td>
                                <span class="star-rating">
                                    <i class="fas fa-star" th:each="i : ${#numbers.sequence(1, review.rating.intValue())}"></i>
                                </span>
                        <span class="small text-muted ms-1" th:text="${'(' + review.rating + ')'}"></span>
                    </td>
                    <td>
                        <div class="d-flex">
                            <i class="fas fa-quote-left text-muted me-2 small opacity-50"></i>
                            <span th:text="${review.comment}" class="fst-italic text-dark"></span>
                        </div>
                    </td>
                    <td>
                        <div class="d-flex align-items-center">
                            <div class="avatar-circle bg-light text-warning me-2 rounded-circle d-flex align-items-center justify-content-center" style="width: 35px; height: 35px;">
                                <i class="fas fa-user"></i>
                            </div>
                            <div>
                                <div class="fw-bold" th:text="${review.wellbeing.adoption.adoptRequest.adopter.username}">User</div>
                                <div class="small text-muted" style="font-size: 0.75rem;">Adopter</div>
                            </div>
                        </div>
                    </td>
                    <td>
                                <span th:if="${review.wellbeing.adoption.adoptRequest.adopter.banStatus == true}" class="badge badge-banned">
                                    <i class="fas fa-ban me-1"></i> BANNED
                                </span>
                        <span th:if="${review.wellbeing.adoption.adoptRequest.adopter.banStatus != true}" class="badge bg-available">
                                    <i class="fas fa-check-circle me-1"></i> Active
                                </span>
                    </td>
                    <td class="text-center">
                        <a th:if="${review.wellbeing.adoption.adoptRequest.adopter.banStatus != true}"
                           th:href="@{'/admin/ban-user/' + ${review.wellbeing.adoption.adoptRequest.adopter.username}}"
                           class="btn btn-ban shadow-sm"
                           onclick="return confirm('‚ö†Ô∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏ö‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ô‡∏µ‡πâ?');">
                            <i class="fas fa-ban me-1"></i> Ban
                        </a>

                        <a th:if="${review.wellbeing.adoption.adoptRequest.adopter.banStatus == true}"
                           th:href="@{'/admin/unban-user/' + ${review.wellbeing.adoption.adoptRequest.adopter.username}}"
                           class="btn btn-outline-secondary btn-sm rounded-pill px-3"
                           onclick="return confirm('‡∏õ‡∏•‡∏î‡πÅ‡∏ö‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ô‡∏µ‡πâ?');">
                            <i class="fas fa-unlock me-1"></i> Unban
                        </a>
                    </td>
                </tr>
                </tbody>
            </table>

            <div th:if="${reviews.isEmpty()}" class="empty-state">
                <div class="mb-3">
                    <i class="fas fa-comments fa-4x text-muted opacity-50"></i>
                </div>
                <h5 class="text-muted">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏µ‡∏ß‡∏¥‡∏ß</h5>
                <p class="small text-secondary" th:if="${filterMode == 'bad'}">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 3 ‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</p>
            </div>
        </div>
    </div>

    <div class="text-center mt-4 text-muted small">
        &copy; 2026 Home4Paws Admin Panel
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>